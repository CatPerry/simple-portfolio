/*! UIkit 3.0.0-rc.6 | http://www.getuikit.com | (c) 2014 - 2017 YOOtheme | MIT License */

!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("uikit-util")):"function"==typeof define&&define.amd?define("uikitupload",["uikit-util"],t):t(e.UIkit.util)}(this,function(a){"use strict";var e={props:{allow:String,clsDragover:String,concurrent:Number,maxSize:Number,method:String,mime:String,msgInvalidMime:String,msgInvalidName:String,msgInvalidSize:String,multiple:Boolean,name:String,params:Object,type:String,url:String},data:{allow:!1,clsDragover:"uk-dragover",concurrent:1,maxSize:0,method:"POST",mime:!1,msgInvalidMime:"Invalid File Type: %s",msgInvalidName:"Invalid File Name: %s",msgInvalidSize:"Invalid File Size: %s Kilobytes Max",multiple:!1,name:"files[]",params:{},type:"",url:"",abort:a.noop,beforeAll:a.noop,beforeSend:a.noop,complete:a.noop,completeAll:a.noop,error:a.noop,fail:a.noop,load:a.noop,loadEnd:a.noop,loadStart:a.noop,progress:a.noop},events:{change:function(e){a.matches(e.target,'input[type="file"]')&&(e.preventDefault(),e.target.files&&this.upload(e.target.files),e.target.value="")},drop:function(e){i(e);var t=e.dataTransfer;t&&t.files&&(a.removeClass(this.$el,this.clsDragover),this.upload(t.files))},dragenter:function(e){i(e)},dragover:function(e){i(e),a.addClass(this.$el,this.clsDragover)},dragleave:function(e){i(e),a.removeClass(this.$el,this.clsDragover)}},methods:{upload:function(e){var i=this;if(e.length){a.trigger(this.$el,"upload",[e]);for(var t=0;t<e.length;t++){if(i.maxSize&&1e3*i.maxSize<e[t].size)return void i.fail(i.msgInvalidSize.replace("%s",i.maxSize));if(i.allow&&!o(i.allow,e[t].name))return void i.fail(i.msgInvalidName.replace("%s",i.allow));if(i.mime&&!o(i.mime,e[t].type))return void i.fail(i.msgInvalidMime.replace("%s",i.mime))}this.multiple||(e=[e[0]]),this.beforeAll(this,e);var n=function(e,t){for(var o=[],i=0;i<e.length;i+=t){for(var n=[],r=0;r<t;r++)n.push(e[i+r]);o.push(n)}return o}(e,this.concurrent),r=function(e){var t=new FormData;for(var o in e.forEach(function(e){return t.append(i.name,e)}),i.params)t.append(o,i.params[o]);a.ajax(i.url,{data:t,method:i.method,responseType:i.type,beforeSend:function(e){var t=e.xhr;t.upload&&a.on(t.upload,"progress",i.progress),["loadStart","load","loadEnd","abort"].forEach(function(e){return a.on(t,e.toLowerCase(),i[e])}),i.beforeSend(e)}}).then(function(e){i.complete(e),n.length?r(n.shift()):i.completeAll(e)},function(e){return i.error(e.message)})};r(n.shift())}}}};function o(e,t){return t.match(new RegExp("^"+e.replace(/\//g,"\\/").replace(/\*\*/g,"(\\/[^\\/]+)*").replace(/\*/g,"[^\\/]+").replace(/((?!\\))\?/g,"$1.")+"$","i"))}function i(e){e.preventDefault(),e.stopPropagation()}"undefined"!=typeof window&&window.UIkit&&window.UIkit.component("upload",e)});